/*! For license information please see download.98e81d432bd398283cd5.js.LICENSE.txt */
(self.webpackChunkmvp=self.webpackChunkmvp||[]).push([[467],{303:function(n,o,t){"use strict";var e=t(713);function i(){const n=window.navigator.userAgent;return null==n||!1===n?"Other":n.indexOf("Android")>=0?"Android":n.indexOf("Mac OS X")>=0&&n.indexOf("Mobile")>=0?"iOS":n.indexOf("Windows")>=0?"Windows":n.indexOf("Mac_PowerPC")>=0||n.indexOf("Macintosh")>=0?"macOS":n.indexOf("Linux")>=0?"Linux":"Unknown"}var a=e.A.then((n=>{const o=`${function(){let n=window.location.origin;return null==n&&(n=`${window.location.protocol}//${window.location.hostname}`,window.location.port&&(n=`${n}:${window.location.port}`)),n=n.split("#")[0],"/"===n[n.length-1]&&(n=n.substring(0,n.length-1)),n}()}/api/config`;return new Promise(((t,e)=>{n.getJSON(o).done((n=>(console.log("Sitewide configuration loaded"),console.log("Config at loading:"),console.log(n),t(n)))).fail(((n,o,t)=>(console.error(`Failed to grab sitewide configuration with ${o}`),console.error(t),e(t))))}))})),l=t(572);Promise.all([a,e.A,l.P]).then((n=>{let[o,t,e]=n;console.log("Config at download.js:"),console.log(o),t(document).ready((()=>{let n="amount-twenty",a="amount-twenty";function l(){const n=t("#translate-download").text(),o=t("#translate-purchase").text();t("#choice-buttons").children().length<=1?t("#download").text(n):t("button.payment-button").hasClass("checked")||100*t("#amount-custom").val()>=100||""===t("#amount-custom").val()?t("#download").text(o):t("#download").text(n)}t(".target-amount").on("click focusin",(function(o){const e=t(o.target).attr("id");console.log("Setting payment target to #"+e),n!==e&&(a=n),n=e,t(".target-amount").removeClass("checked"),t("#"+n).addClass("checked"),l()})),t("#amount-custom").keypress((function(n){const o=t("#amount-custom").val(),e=n.which||n.keyCode||n.charCode;46===e&&-1===o.indexOf(".")||-1!==[8,37,39].indexOf(e)||!(e<48||e>57)||n.preventDefault()})),t("#amount-custom").blur((function(){const o=document.getElementById("amount-custom");o.validity.valid&&""!==o.value||(t(".target-amount").removeClass("checked"),n=a,t("#"+n).addClass("checked"),l())})),t("#choice-buttons").on("click",l),t("#choice-buttons input").on("input",l),l(),t("#download").click((function(o){o.preventDefault(),console.log("Payment initiated with selection "+n);const i=100*t("#"+n).val();console.log("Starting payment for "+i),t("#hidden-amount").val(i);const a=t(this);a.prop("disabled",!0),setTimeout((function(){a.prop("disabled",!1)}),3e3),Number.isNaN(i)||i<100?(plausible("Payment",{props:{Input:i.toString(),Amount:"0",Action:"Skipped"}}),e()):t("#payment-form").submit()})),t(".download-link").click((function(){let n="Unknown";t(this).hasClass("magnet")&&(n="Magnet"),t(this).hasClass("http")&&(n="HTTP"),plausible("Download",{props:{Region:o.user.region,Method:n,OS:i(),Version:o.release.version}})})),console.log("Loaded download.js")}))}))},491:function(n,o,t){var e,i,a;a=function(){var n,o,t=document,e=t.getElementsByTagName("head")[0],i="push",a="readyState",l="onreadystatechange",c={},s={},r={},u={};function d(n,o){for(var t=0,e=n.length;t<e;++t)if(!o(n[t]))return!1;return 1}function f(n,o){d(n,(function(n){return o(n),1}))}function m(o,t,e){o=o[i]?o:[o];var a=t&&t.call,l=a?t:e,g=a?o.join(""):t,p=o.length;function w(n){return n.call?n():c[n]}function v(){if(! --p)for(var n in c[g]=1,l&&l(),r)d(n.split("|"),w)&&!f(r[n],w)&&(r[n]=[])}return setTimeout((function(){f(o,(function o(t,e){return null===t?v():(e||/^https?:\/\//.test(t)||!n||(t=-1===t.indexOf(".js")?n+t+".js":n+t),u[t]?(g&&(s[g]=1),2==u[t]?v():setTimeout((function(){o(t,!0)}),0)):(u[t]=1,g&&(s[g]=1),void h(t,v)))}))}),0),m}function h(n,i){var c,s=t.createElement("script");s.onload=s.onerror=s[l]=function(){s[a]&&!/^c|loade/.test(s[a])||c||(s.onload=s[l]=null,c=1,u[n]=2,i())},s.async=1,s.src=o?n+(-1===n.indexOf("?")?"?":"&")+o:n,e.insertBefore(s,e.lastChild)}return m.get=h,m.order=function(n,o,t){!function e(i){i=n.shift(),n.length?m(i,e):m(i,o,t)}()},m.path=function(o){n=o},m.urlArgs=function(n){o=n},m.ready=function(n,o,t){n=n[i]?n:[n];var e,a=[];return!f(n,(function(n){c[n]||a[i](n)}))&&d(n,(function(n){return c[n]}))?o():(e=n.join("|"),r[e]=r[e]||[],r[e][i](o),t&&t(a)),m},m.done=function(n){m([null],n)},m},n.exports?n.exports=a():void 0===(i="function"==typeof(e=a)?e.call(o,t,o,n):e)||(n.exports=i)},572:function(n,o,t){"use strict";t.d(o,{P:function(){return a}});var e=t(491),i=t(713).A.then((n=>new Promise(((n,o)=>{e("https://cdn.jsdelivr.net/gh/eustasy/jQuery.leanModal2@2.6.3/jQuery.leanModal2.min.js",(()=>(console.log("jQuery.leanModal2 loaded"),n(window.jQuery))))}))));function a(){i.then((n=>{const o=n(".open-modal");console.log("Open the download overlay!"),o.leanModal({closeButton:".close-modal",disableCloseOnOverlayClick:!0}),o.click()}))}},713:function(n,o,t){"use strict";var e=t(491);o.A=new Promise(((n,o)=>{e("https://cdn.jsdelivr.net/gh/jquery/jquery@3/dist/jquery.min.js",(()=>(console.log("jQuery loaded"),n(window.jQuery))))}))}},function(n){n(n.s=303)}]);
//# sourceMappingURL=download.98e81d432bd398283cd5.js.map